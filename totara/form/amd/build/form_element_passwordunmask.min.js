define(["jquery","totara_form/form"],function(a,b){function c(a,d,e,f){return this instanceof c?(this.input=null,this.unmaskinput=null,void b.Element.apply(this,arguments)):new c(a,d,e,f)}return String.prototype.repeat||(String.prototype.repeat=function(a){"use strict";if(null==this)throw new TypeError("can't convert "+this+" to object");var b=""+this;if(a=+a,a!=a&&(a=0),a<0)throw new RangeError("repeat count must be non-negative");if(a==1/0)throw new RangeError("repeat count must be less than infinity");if(a=Math.floor(a),0==b.length||0==a)return"";if(b.length*a>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");for(var c="";1==(1&a)&&(c+=b),a>>>=1,0!=a;)b+=b;return c}),c.prototype=Object.create(b.Element.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return"[object PasswordUnmaskElement]"},c.prototype.init=function(b){var c=this.id,d=a("#"+c),e=[];if(this.input=d,this.unmaskinput=a("#"+c+"unmask"),this.wrap=this.input.parent(".wrap"),a('<input type="text" value="" class="inputmask" />').insertBefore("#"+c),this.mask=this.wrap.find(".inputmask"),this.updateMask(),this.mask.focus(function(a){d.focus()}),this.unmaskinput.change(a.proxy(this.unmask,this)),this.input.keyup(a.proxy(this.updateMask,this)),this.input.mouseup(),this.input.change(a.proxy(this.changed,this)),this.input.attr("required")){var f=a.Deferred();e.push(f),require(["totara_form/modernizr"],function(a){a.input.required?f.resolve():require(["totara_form/polyfill_required-lazy"],function(a){a.init(c),f.resolve()})})}if(this.input.attr("placeholder")){var g=a.Deferred();e.push(g),require(["totara_form/modernizr"],function(a){a.input.placeholder?g.resolve():require(["totara_form/polyfill_placeholder-lazy"],function(a){a.init(c),g.resolve()})})}a.when.apply(a,e).done(b)},c.prototype.updateMask=function(){this.mask.val("‚óè".repeat(this.input.val().length))},c.prototype.unmask=function(){this.unmaskinput.is(":checked")?this.input.parents(".totara_form_element_passwordunmask").addClass("unmask-password"):this.input.parents(".totara_form_element_passwordunmask").removeClass("unmask-password")},c.prototype.getValue=function(){return this.input?this.input.val():null},c});