define(["jquery","core/notification","core/ajax","core/log","tool_lp/grade_dialogue","tool_lp/event_base"],function(a,b,c,d,e,f){var g=function(b,c,d,e,g,h,i,j,k){f.prototype.constructor.apply(this,[]);var l=a(b);if(!l.length)throw new Error("Could not find the trigger");this._scaleConfig=c,this._competencyId=d,this._userId=e,this._planId=g,this._courseId=h,this._chooseStr=i,this._canGrade=j,this._canSuggest=k,this._setUp(),l.click(function(a){a.preventDefault(),this._dialogue.display()}.bind(this)),this._planId?(this._methodName="tool_lp_grade_competency_in_plan",this._args={competencyid:this._competencyId,planid:this._planId}):this._courseId?(this._methodName="tool_lp_grade_competency_in_course",this._args={competencyid:this._competencyId,courseid:this._courseId,userid:this._userId}):(this._methodName="tool_lp_grade_competency",this._args={userid:this._userId,competencyid:this._competencyId})};return g.prototype=Object.create(f.prototype),g.prototype._setUp=function(){var a=[],d=this;a.push({value:"",name:this._chooseStr});for(var f=1;f<this._scaleConfig.length;f++){var g=this._scaleConfig[f];a.push({value:g.id,name:g.name})}this._dialogue=new e(a,this._canGrade,this._canSuggest),this._dialogue.on("rated",function(a,e){var f=this._args;f.grade=e.rating,f.note=e.note,f.override=!0,c.call([{methodname:this._methodName,args:f,done:function(a){this._trigger("competencyupdated",{args:f,evidence:a})}.bind(d),fail:b.exception}])}.bind(this)),this._dialogue.on("suggested",function(a,e){var f=this._args;f.grade=e.rating,f.note=e.note,f.override=!1,c.call([{methodname:this._methodName,args:f,done:function(a){this._trigger("competencyupdated",{args:f,evidence:a})}.bind(d),fail:b.exception}])}.bind(this))},g.prototype._scaleConfig=null,g.prototype._competencyId=null,g.prototype._userId=null,g.prototype._planId=null,g.prototype._courseId=null,g.prototype._dialogue=null,g.prototype._canGrade=null,g.prototype._canSuggest=null,g});