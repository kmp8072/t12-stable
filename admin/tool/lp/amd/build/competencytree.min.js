define(["core/ajax","core/notification","jquery"],function(a,b,c){var d=[],e=0,f=function(b){var f=c.Deferred();b="";var g=a.call([{methodname:"tool_lp_search_competencies",args:{searchtext:b,competencyframeworkid:e,includerelated:!0}}]);return g[0].done(function(a){d=[];var b=0;for(b=0;b<a.length;b++)d[a[b].id]=a[b];f.resolve(d)}).fail(function(a){f.reject(a)}),f.promise()};return{init:function(a){e=a,f("").fail(b.exception)},getCompetencyFrameworkId:function(){return e},getCompetency:function(a){return d[a]},getCompetencyLevel:function(a){var b=this.getCompetency(a),c=b.path.replace(/^\/|\/$/g,"").split("/").length;return c},reloadCompetencies:function(){return f("").fail(b.exception)},listCompetencies:function(){return d},applySearch:function(a){return f(a)}}});